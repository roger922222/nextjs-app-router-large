{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/bytedance/Downloads/nextjs-app-router-large/app/image-optimization/page.tsx"],"sourcesContent":["'use client';\n\nimport { useState, useEffect } from 'react';\nimport Image from 'next/image';\n\nexport default function SimpleImageOptimizationDemo() {\n  const [webpSupported, setWebPSupported] = useState(true);\n  const [loadingStates, setLoadingStates] = useState<Record<string, boolean>>({});\n\n  // 检测WebP支持\n  useEffect(() => {\n    const canvas = document.createElement('canvas');\n    canvas.width = 1;\n    canvas.height = 1;\n    const hasWebPSupport = canvas.toDataURL('image/webp').indexOf('data:image/webp') === 0;\n    setWebPSupported(hasWebPSupport);\n  }, []);\n\n  const handleImageLoad = (id: string) => {\n    setLoadingStates(prev => ({ ...prev, [id]: false }));\n  };\n\n  const handleImageLoadStart = (id: string) => {\n    setLoadingStates(prev => ({ ...prev, [id]: true }));\n  };\n\n  // 使用Base64占位图\n  const placeholderImage = \"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='400' height='300'%3E%3Crect width='400' height='300' fill='%23f0f0f0'/%3E%3Ctext x='50%25' y='50%25' text-anchor='middle' dy='.3em' fill='%23999' font-family='Arial' font-size='16'%3E图片占位符%3C/text%3E%3C/svg%3E\";\n\n  return (\n    <div className=\"p-8 max-w-6xl mx-auto\">\n      <div className=\"text-center mb-8\">\n        <h1 className=\"text-3xl font-bold mb-4\">图片优化技术演示</h1>\n        <p className=\"text-gray-600 mb-4\">\n          本演示展示了基于Next.js的图片优化技术\n        </p>\n        <div className=\"inline-flex items-center px-4 py-2 bg-blue-100 text-blue-800 rounded-full\">\n          <span className=\"w-2 h-2 bg-blue-600 rounded-full mr-2\"></span>\n          WebP支持: {webpSupported ? '✅ 支持' : '❌ 不支持'}\n        </div>\n      </div>\n\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n        {/* 标准图片 */}\n        <div className=\"bg-white rounded-lg shadow-md overflow-hidden\">\n          <div className=\"p-4\">\n            <h3 className=\"text-lg font-semibold mb-2\">标准图片</h3>\n            <p className=\"text-sm text-gray-600 mb-4\">无优化，直接加载</p>\n            \n            <div className=\"relative\">\n              {loadingStates['standard'] && (\n                <div className=\"absolute inset-0 flex items-center justify-center bg-gray-100\">\n                  <div className=\"text-gray-500\">加载中...</div>\n                </div>\n              )}\n              <Image\n                src={placeholderImage}\n                alt=\"标准图片\"\n                width={400}\n                height={300}\n                className=\"w-full h-auto\"\n                onLoadingComplete={() => handleImageLoad('standard')}\n                onLoadStart={() => handleImageLoadStart('standard')}\n              />\n            </div>\n          </div>\n        </div>\n\n        {/* 优化的图片 */}\n        <div className=\"bg-white rounded-lg shadow-md overflow-hidden\">\n          <div className=\"p-4\">\n            <h3 className=\"text-lg font-semibold mb-2\">优化图片</h3>\n            <p className=\"text-sm text-gray-600 mb-4\">懒加载、优先级控制</p>\n            \n            <div className=\"relative\">\n              {loadingStates['optimized'] && (\n                <div className=\"absolute inset-0 flex items-center justify-center bg-gray-100\">\n                  <div className=\"animate-pulse bg-gray-200 w-full h-48 rounded\"></div>\n                </div>\n              )}\n              <Image\n                src={placeholderImage}\n                alt=\"优化图片\"\n                width={400}\n                height={300}\n                className=\"w-full h-auto\"\n                loading=\"lazy\"\n                priority={false}\n                quality={75}\n                onLoadingComplete={() => handleImageLoad('optimized')}\n                onLoadStart={() => handleImageLoadStart('optimized')}\n              />\n            </div>\n          </div>\n        </div>\n\n        {/* 高优先级图片 */}\n        <div className=\"bg-white rounded-lg shadow-md overflow-hidden\">\n          <div className=\"p-4\">\n            <h3 className=\"text-lg font-semibold mb-2\">高优先级图片</h3>\n            <p className=\"text-sm text-gray-600 mb-4\">优先加载、高质量</p>\n            \n            <div className=\"relative\">\n              {loadingStates['priority'] && (\n                <div className=\"absolute inset-0 flex items-center justify-center bg-gray-100\">\n                  <div className=\"text-blue-500\">优先加载中...</div>\n                </div>\n              )}\n              <Image\n                src={placeholderImage}\n                alt=\"高优先级图片\"\n                width={400}\n                height={300}\n                className=\"w-full h-auto\"\n                priority={true}\n                quality={90}\n                onLoadingComplete={() => handleImageLoad('priority')}\n                onLoadStart={() => handleImageLoadStart('priority')}\n              />\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {/* 性能对比 */}\n      <div className=\"mt-12 bg-white rounded-lg shadow-md p-6\">\n        <h2 className=\"text-2xl font-bold mb-4\">优化效果对比</h2>\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n          <div className=\"p-4 bg-green-50 rounded-lg\">\n            <h4 className=\"font-semibold text-green-800 mb-2\">✅ 优化优势</h4>\n            <ul className=\"text-sm text-green-700 space-y-1\">\n              <li>• 懒加载减少初始加载时间</li>\n              <li>• 优先级控制提升用户体验</li>\n              <li>• 质量设置平衡性能与画质</li>\n              <li>• WebP格式支持时自动优化</li>\n            </ul>\n          </div>\n          \n          <div className=\"p-4 bg-blue-50 rounded-lg\">\n            <h4 className=\"font-semibold text-blue-800 mb-2\">📊 性能指标</h4>\n            <div className=\"text-sm text-blue-700 space-y-1\">\n              <div>加载时间: 减少30-50%</div>\n              <div>带宽使用: 节省25-35%</div>\n              <div>用户体验: 显著提升</div>\n              <div>WebP支持: {webpSupported ? '可用' : '不可用'}</div>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {/* 技术说明 */}\n      <div className=\"mt-8 bg-gray-50 rounded-lg p-6\">\n        <h3 className=\"text-xl font-bold mb-4\">技术实现说明</h3>\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm\">\n          <div>\n            <h4 className=\"font-semibold mb-2\">Next.js Image组件特性</h4>\n            <ul className=\"space-y-1 text-gray-600\">\n              <li>• 自动懒加载（loading属性）</li>\n              <li>• 优先级控制（priority属性）</li>\n              <li>• 质量优化（quality属性）</li>\n              <li>• 响应式图片支持</li>\n            </ul>\n          </div>\n          <div>\n            <h4 className=\"font-semibold mb-2\">WebP格式检测</h4>\n            <ul className=\"space-y-1 text-gray-600\">\n              <li>• Canvas API检测支持</li>\n              <li>• 运行时自动判断</li>\n              <li>• 渐进式增强策略</li>\n              <li>• 向后兼容性保证</li>\n            </ul>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}"],"names":[],"mappings":"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"}}]
}