{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 18, "column": 0}, "map": {"version":3,"sources":["file:///Users/bytedance/Downloads/nextjs-app-router-large/lib/http.ts"],"sourcesContent":["// lib/http.ts\n// 在服务器组件/Route Handler 中构造绝对 baseUrl，避免相对路径问题\nimport { headers } from \"next/headers\";\n\nexport async function getBaseUrl() {\n  const h = await headers();\n  const proto = h.get(\"x-forwarded-proto\") || \"http\";\n  const host = h.get(\"host\") || \"localhost:3000\";\n  return `${proto}://${host}`;\n}\n"],"names":[],"mappings":"AAAA,cAAc;AACd,8CAA8C;;;;;AAC9C;;AAEO,eAAe;IACpB,MAAM,IAAI,MAAM,IAAA,0IAAO;IACvB,MAAM,QAAQ,EAAE,GAAG,CAAC,wBAAwB;IAC5C,MAAM,OAAO,EAAE,GAAG,CAAC,WAAW;IAC9B,OAAO,GAAG,MAAM,GAAG,EAAE,MAAM;AAC7B"}},
    {"offset": {"line": 36, "column": 0}, "map": {"version":3,"sources":["file:///Users/bytedance/Downloads/nextjs-app-router-large/app/server/dedup/page.tsx"],"sourcesContent":["import { getBaseUrl } from \"@/lib/http\";\n\nexport default async function ServerDedupPage() {\n  const baseUrl = await getBaseUrl();\n  // 同一请求上下文中，两次完全相同的 fetch 调用会被 Request Memoization 去重\n  const options: RequestInit = { cache: \"no-store\" };\n  const r1 = await fetch(`${baseUrl}/api/metrics`, options);\n  const r2 = await fetch(`${baseUrl}/api/metrics`, options);\n  const [a, b] = await Promise.all([r1.json(), r2.json()]);\n\n  return (\n    <div>\n      <section>\n        <h2>服务器组件：请求去重（Request Memoization）</h2>\n        <p>预期同一渲染内仅调用一次后端，两个结果相同（count 不会增长两次）。</p>\n        <pre>第一次返回：count={a.count} ts={new Date(a.ts).toLocaleTimeString()}</pre>\n        <pre>第二次返回：count={b.count} ts={new Date(b.ts).toLocaleTimeString()}</pre>\n      </section>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AAAA;;;AAEe,eAAe;IAC5B,MAAM,UAAU,MAAM,IAAA,yHAAU;IAChC,qDAAqD;IACrD,MAAM,UAAuB;QAAE,OAAO;IAAW;IACjD,MAAM,KAAK,MAAM,MAAM,GAAG,QAAQ,YAAY,CAAC,EAAE;IACjD,MAAM,KAAK,MAAM,MAAM,GAAG,QAAQ,YAAY,CAAC,EAAE;IACjD,MAAM,CAAC,GAAG,EAAE,GAAG,MAAM,QAAQ,GAAG,CAAC;QAAC,GAAG,IAAI;QAAI,GAAG,IAAI;KAAG;IAEvD,qBACE,8OAAC;kBACC,cAAA,8OAAC;;8BACC,8OAAC;8BAAG;;;;;;8BACJ,8OAAC;8BAAE;;;;;;8BACH,8OAAC;;wBAAI;wBAAa,EAAE,KAAK;wBAAC;wBAAK,IAAI,KAAK,EAAE,EAAE,EAAE,kBAAkB;;;;;;;8BAChE,8OAAC;;wBAAI;wBAAa,EAAE,KAAK;wBAAC;wBAAK,IAAI,KAAK,EAAE,EAAE,EAAE,kBAAkB;;;;;;;;;;;;;;;;;;AAIxE"}}]
}